<%@ page pageEncoding="UTF-8"%>

<h1>Problem F: Great Devil Sakanikia</h1>
<h2>Problem</h2>

<p>
大悪魔サカーニャは今日も天敵の猫に襲われていた。<br>
いつもやられている訳にはいかないので、秘密兵器を購入した。<br>
この秘密兵器は巨大な岩を生成することができる。<br>
巨大な岩で移動経路を塞いで、猫がこちらに近づけないようにすることにした。<br>
</p>
<p>
今サカーニャ達はマス(0,0),(<var>n</var>&minus;1,0),(<var>n</var>&minus;1,<var>m</var>&minus;1),(0,<var>m</var>&minus;1)で囲まれた長方形の閉区間内にいて、範囲外に出ることはできない。<br>
マス(0,0)に猫がいて、マス(<var>n</var>&minus;1,<var>m</var>&minus;1)にサカーニャがいる。<br>
猫は上下左右のマスに移動できる。<br>
いくつかのマスは穴が空いていたり、障害物があったりしていて、侵入することができない。<br>
1つ岩を生成することで1マス侵入できなくすることができる。<br>
ただし、マス(0,0)とマス(<var>n</var>&minus;1,<var>m</var>&minus;1)に岩を生成することはできない。<br>
マス(0,0)からマス(<var>n</var>&minus;1,<var>m</var>&minus;1)までの移動経路を塞ぐために必要な生成する岩の数の最小値を求めよ。<br>
</p>

<h2>Input</h2>

<pre>
<var>n</var> <var>m</var> <var>k</var>
<var>x<sub>1</sub></var> <var>y<sub>1</sub></var>
...
<var>x<sub>k</sub></var> <var>y<sub>k</sub></var>
</pre>

<p>
入力は全て整数で与えられる。<br>
1行目に<var>n</var>と<var>m</var>と侵入できないマスの数<var>k</var>が空白区切りで与えられる。<br>
2行目から<var>k</var>行に侵入できないマスの座標が与えられる。
</p>

<h2>Constraints</h2>
入力は以下の条件を満たす。
<ul>
  <li>2 &le; <var>n</var>,<var>m</var> &le; 10<sup>5</sup></li>
  <li>0 &le; <var>k</var> &le; min(<var>n</var>×<var>m</var>&minus;2,10<sup>5</sup>)</li>
  <li>0 &le; <var>x<sub>i</sub></var> &le; <var>n</var> &minus; 1</li>
  <li>0 &le; <var>y<sub>i</sub></var> &le; <var>m</var> &minus; 1</li>
  <li>(<var>x<sub>i</sub></var>,<var>y<sub>i</sub></var>) &ne; (<var>x<sub>j</sub></var>,<var>y<sub>j</sub></var>) (<var>i</var> &ne; <var>j</var>)</li>
  <li>(<var>x<sub>i</sub></var>,<var>y<sub>i</sub></var>) &ne; (0,0) &ne; (<var>n</var>&minus;1,<var>m</var>&minus;1)</li>
</ul>

<h2>Output</h2>
<p>
マス(0,0)からマス(<var>n</var>&minus;1,<var>m</var>&minus;1)までの移動経路を塞ぐために必要な生成する岩の数の最小値を1行に出力せよ。<br>
</p>

<h2>Sample Input 1</h2>
<pre>
3 5 2
0 2
2 2
</pre>

<h2>Sample Output 1</h2>
<pre>
1
</pre>

<h2>Sample Input 2</h2>
<pre>
5 5 3
0 2
2 2
4 1
</pre>

<h2>Sample Output 2</h2>
<pre>
2
</pre>
